"use strict";(self["webpackChunkjb_web_app"]=self["webpackChunkjb_web_app"]||[]).push([[536],{40536:function(t,e,a){a.r(e),a.d(e,{default:function(){return it}});var r=a(73396),s=a(87139);const o=t=>((0,r.dD)("data-v-6f9f629c"),t=t(),(0,r.Cn)(),t),i={class:"reports"},n={class:"filter-container"},l=o((()=>(0,r._)("h3",null,"Guia de pagamento",-1))),p={style:{display:"flex",gap:"10px"}},h=o((()=>(0,r._)("i",{class:"pi pi-chart-bar"},null,-1))),d=(0,r.Uk)("   "),c=o((()=>(0,r._)("div",{class:"section-header"},[(0,r._)("h4",null,"GUIA")],-1))),m={class:"row"},u=o((()=>(0,r._)("span",null,"Ponto",-1))),w={class:"row"},f=o((()=>(0,r._)("span",null,"Anterior: ",-1))),g={class:"row"},y=o((()=>(0,r._)("span",null,"Vendas",-1))),_={class:"row"},x=o((()=>(0,r._)("span",null,"Cancelamentos",-1))),v={class:"row"},C=o((()=>(0,r._)("span",null,"Comissão",-1))),b={class:"row"},T=o((()=>(0,r._)("span",null,"Prêmios",-1))),D={class:"row"},$=o((()=>(0,r._)("span",null,"Reclamação",-1))),k={class:"row"},R=o((()=>(0,r._)("span",null,"Despesa",-1))),E={class:"row"},P=o((()=>(0,r._)("span",null,"Recebido",-1))),z={class:"row"},F=o((()=>(0,r._)("span",null,"Enviado",-1))),A={class:"row"},S=o((()=>(0,r._)("span",null,"Cana",-1))),M={class:"row"},L=o((()=>(0,r._)("div",{style:{"margin-top":"30px"},class:"section-header"},[(0,r._)("h4",null,"DETALHAMENTO DE DESPESA")],-1))),U={class:"row"},j=o((()=>(0,r._)("span",null,"Total",-1))),V={key:1,class:"summary"},O=o((()=>(0,r._)("span",null,"RESUMO",-1))),Y=o((()=>(0,r._)("i",{class:"far fa-chevron-down"},null,-1))),H=[O,Y],G={key:2,class:"summary"},I=o((()=>(0,r._)("span",null,"PRÊMIOS",-1))),Z=o((()=>(0,r._)("i",{class:"far fa-chevron-down"},null,-1))),q=[I,Z];function B(t,e,a,o,O,Y){const I=(0,r.up)("Button"),Z=(0,r.up)("Dropdown"),B=(0,r.up)("Calendar"),W=(0,r.up)("Divider");return(0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",n,[l,(0,r._)("div",p,[(0,r.Wm)(I,{class:"btn-icon",onClick:e[0]||(e[0]=t=>Y.toggleFilter()),icon:"fas fa-sliders"}),(0,r.Wm)(I,{class:"btn-icon",onClick:e[1]||(e[1]=t=>Y.toggleCalendar()),icon:"pi pi-calendar"}),t.$store.getters.getRegionConfig.can_print?((0,r.wg)(),(0,r.j4)(I,{key:0,loading:O.loading,class:"btn-icon",icon:"fas fa-print",onClick:e[2]||(e[2]=t=>Y.handleButtonPrint())},null,8,["loading"])):(0,r.kq)("",!0)])]),t.$store.getters.getProducts.bolao_dezenas?.habilitado&&O.showFilter?((0,r.wg)(),(0,r.j4)(Z,{key:0,onChange:e[3]||(e[3]=t=>Y.loadReport()),modelValue:O.reportType,"onUpdate:modelValue":e[4]||(e[4]=t=>O.reportType=t),options:["Geral","Bolão de dezenas"]},null,8,["modelValue"])):(0,r.kq)("",!0),(0,r.Wm)(B,{style:(0,s.j5)(O.showCalendar?"display: flex":"display: none"),inline:"",maxDate:new Date,modelValue:O.date_search,"onUpdate:modelValue":e[5]||(e[5]=t=>O.date_search=t),selectionMode:"range",manualInput:!1},null,8,["style","maxDate","modelValue"]),(0,r._)("fieldset",null,[(0,r._)("legend",null,[h,d,(0,r._)("span",null,(0,s.zw)(t.formatDate(O.date_search[0])==t.formatDate(O.date_search[1])?t.formatDate(O.date_search[0]):t.formatDate(O.date_search[0])+" à "+t.formatDate(O.date_search[1])),1)]),c,(0,r._)("p",m,[u,(0,r._)("span",null,(0,s.zw)(this.loggedUser().point_name),1)]),(0,r._)("p",w,[f,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.dev_anterior))),1)]),(0,r._)("p",g,[y,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.vendas))),1)]),(0,r._)("p",_,[x,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.cancelamentos))),1)]),(0,r._)("p",v,[C,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.comissao))),1)]),(0,r._)("p",b,[T,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.premios))),1)]),(0,r._)("p",D,[$,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.reclamacao))),1)]),(0,r._)("p",k,[R,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.despesa))),1)]),(0,r._)("p",E,[P,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.recebido))),1)]),(0,r._)("p",z,[F,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.enviado))),1)]),(0,r._)("p",A,[S,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.cana))),1)]),(0,r.Wm)(W),(0,r._)("p",M,[(0,r._)("span",null,(0,s.zw)(O.report.haver>0?"Dev":"Haver"),1),(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.haver))),1)]),O.report.expenseDetails.length>0?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[L,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(O.report.expenseDetails,((t,e)=>((0,r.wg)(),(0,r.iD)("p",{class:"row",key:e},[(0,r._)("span",null,(0,s.zw)(t.description),1),(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(t.value))),1)])))),128)),(0,r.Wm)(W),(0,r._)("p",U,[j,(0,r._)("span",null,(0,s.zw)(this.formatCurrency(parseFloat(O.report.despesa))),1)])],64)):(0,r.kq)("",!0)]),O.report.vendaPorExtracao&&O.report.vendaPorExtracao.length>0?((0,r.wg)(),(0,r.iD)("div",V,[(0,r._)("div",{class:"summary-header",onClick:e[6]||(e[6]=t=>Y.toggleSummary())},H),O.showSummary?((0,r.wg)(!0),(0,r.iD)(r.HY,{key:0},(0,r.Ko)(O.report.vendaPorExtracao,((t,e)=>((0,r.wg)(),(0,r.iD)("div",{key:e,style:{display:"flex",padding:"5px 20px","flex-direction":"column","justify-content":"center","border-bottom":"solid #3f4b5b 1px"}},[(0,r._)("span",null,(0,s.zw)(t.name),1),(0,r._)("span",null,"Venda: "+(0,s.zw)(this.formatCurrency(parseFloat(t.venda_total))),1),(0,r._)("span",null,"Comissão: "+(0,s.zw)(this.formatCurrency(parseFloat(t.comissao_total))),1),(0,r._)("span",null,"Prêmio: "+(0,s.zw)(this.formatCurrency(parseFloat(t.total_premio))),1)])))),128)):(0,r.kq)("",!0)])):(0,r.kq)("",!0),O.report.bilhetesSorteados&&O.report.bilhetesSorteados.length>0?((0,r.wg)(),(0,r.iD)("div",G,[(0,r._)("div",{class:"summary-header",onClick:e[7]||(e[7]=t=>Y.toggleAwards())},q),O.showAwards?((0,r.wg)(!0),(0,r.iD)(r.HY,{key:0},(0,r.Ko)(O.report.bilhetesSorteados,((t,e)=>((0,r.wg)(),(0,r.iD)("div",{key:e,style:{display:"flex",padding:"5px 20px","flex-direction":"column","justify-content":"center","border-bottom":"solid #3f4b5b 1px"}},[(0,r._)("span",null,"Extração: "+(0,s.zw)(t.name),1),(0,r._)("span",null,"Ticket: "+(0,s.zw)(t.id),1),(0,r._)("span",null,"Prêmio: "+(0,s.zw)(this.formatCurrency(parseFloat(t.total_value))),1)])))),128)):(0,r.kq)("",!0)])):(0,r.kq)("",!0)])}a(82801);var W=a(22419),N=a(43781),K=a(56849),X=a(62711),J=a(31826),Q=a(81937),tt=a(15517),et=a(36797),at=a.n(et),rt={components:{Button:J.Z,Calendar:X.Z,Divider:Q.Z,TabView:N.Z,TabPanel:K.Z,Dialog:W.Z,Dropdown:tt.Z},data(){return{showSummary:!1,showAwards:!1,showCalendar:!1,showFilter:!1,date_search:[new Date,new Date],reportType:"Geral",report:{vendas:0,cancelamentos:0,comissao:0,premios:0,reclamacao:0,despesa:0,recebido:0,enviado:0,dev_anterior:0,cana:0,haver:0,expenseDetails:[],vendaPorExtracao:[]},bluetooth:{connected:!1,characteristics:null},bluetoothAvailable:!1,loading:!1}},created(){this.loadReport()},watch:{date_search:function(t){t[1]&&(this.loadReport(),this.showCalendar=!this.showCalendar)}},methods:{toggleAwards(){this.showAwards=!this.showAwards},toggleSummary(){this.showSummary=!this.showSummary},handleButtonPrint(){var t=this.$store.getters.getPrintMethod;if("Tipo 1"==t){var e=this.drawReport();e.forEach((function(t,e){setTimeout((function(){document.location="rawbt:"+t.toDataURL()}),5e3*e)}))}if("Tipo 2"==t){let t=this.drawReport(1e4)[0];this.loading=!0,t.toBlob((e=>{this.$api.post("/images/stores3",{attachment:e},{headers:{"Content-Type":"multipart/form-data",Authorization:this.accessToken()}}).then((e=>{const a=btoa(e.data.url+`&width=${t.width}`);document.location=`buprinter://print/${a}`,this.loading=!1})).catch((t=>{console.log(t),this.loading=!1}))}))}if("Tipo 3"==t){var a=this.generateHtmlReport();document.location.href=a}if("Tipo 4"==t){let t=this.drawReport(1e4)[0];this.$api.post("/images",{base64:t.toDataURL(),height:t.height,width:t.width},{headers:{Authorization:this.accessToken()}}).then((t=>{document.location=`buprinter://print/${t.data.image.id}`,this.$router.push({path:this.path,replace:!0})})).catch((t=>{console.log(t)}))}if("Tipo 5"==t){let t=this.drawReport(1e4)[0];this.loading=!0,t.toBlob((t=>{this.$api.post("/images/stores3",{attachment:t},{headers:{"Content-Type":"multipart/form-data",Authorization:this.accessToken()}}).then((t=>{document.location=`imageprinterapp://${t.data.url}&width=${this.$store.getters.getPaperSize}`,this.loading=!1})).catch((t=>{console.log(t),this.loading=!1}))}))}},drawReport(t=1250){var e=document.createElement("canvas"),a=this.$store.getters.getPaperSize;e.width="80MM"==a?576:376,e.height=3e4;var r=e.getContext("2d");let s=0,o=10;var i=this.formatDate(this.date_search[0])==this.formatDate(this.date_search[1])?this.formatDate(this.date_search[0]):this.formatDate(this.date_search[0])+" à "+this.formatDate(this.date_search[1]);if(o=this.drawLine(r,s,o),o=this.drawTitle("GUIA DE PAGAMENTO",r,e.width/2,o),o+=10,o=this.drawLine(r,s,o),o=this.drawText("Período: ",r,s,o,8),o=this.drawRightText(`${i}`,r,e.width,o,8),o=this.drawText("Ponto",r,s,o,8),o=this.drawRightText(`${this.loggedUser().point_name}`,r,e.width,o,8),o=this.drawText("Anterior",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.dev_anterior)}`,r,e.width,o,8),o=this.drawText("Vendas",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.vendas)}`,r,e.width,o,8),o=this.drawText("Cancelamentos",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.cancelamentos)}`,r,e.width,o,8),o=this.drawText("Comissão",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.comissao)}`,r,e.width,o,8),o=this.drawText("Prêmios",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.premios)}`,r,e.width,o,8),o=this.drawText("Reclamação",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.reclamacao)}`,r,e.width,o,8),o=this.drawText("Despesa",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.despesa)}`,r,e.width,o,8),o=this.drawText("Recebido",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.recebido)}`,r,e.width,o,8),o=this.drawText("Enviado",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.enviado)}`,r,e.width,o,8),o=this.drawText("Cana",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.cana)}`,r,e.width,o,8),o=this.drawText(this.report.haver>0?"Dev":"Haver",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(this.report.haver)}`,r,e.width,o,8),o=this.drawLine(r,s,o),this.report.vendaPorExtracao.length>0&&(o=this.drawTitle("VENDA POR EXTRAÇÃO",r,e.width/2,o),o=this.drawLine(r,s,o),this.report.vendaPorExtracao.forEach((t=>{o=this.drawText(t.name,r,s,o,8),o=this.drawText("Venda",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(parseFloat(t.venda_total))}`,r,e.width,o,8),o=this.drawText("Comissão",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(parseFloat(t.comissao_total))}`,r,e.width,o,8),o=this.drawLine(r,s,o)}))),this.report.bilhetesSorteados.length>0&&(o=this.drawTitle("PRÊMIOS",r,e.width/2,o),o=this.drawLine(r,s,o),this.report.bilhetesSorteados.forEach((t=>{o=this.drawText(t.name,r,s,o,8),o=this.drawText("Ticket",r,s,o,8),o=this.drawRightText(`${t.id}`,r,e.width,o,8),o=this.drawText("Prêmio",r,s,o,8),o=this.drawRightText(`${this.formatCurrency(parseFloat(t.total_value))}`,r,e.width,o,8),o=this.drawLine(r,s,o)}))),this.report.expenseDetails.length>0){var n=this.formatCurrency(this.report.expenseDetails.reduce(((t,e)=>t+parseFloat(e.value)),0));o=this.drawTitle("DESPESAS",r,e.width/2,o),o=this.drawLine(r,s,o),this.report.expenseDetails.forEach((t=>{var e=t.description.charAt(0).toUpperCase()+t.description.toLowerCase().slice(1);o=this.drawText(`${e}: ${this.formatCurrency(parseFloat(t.value))}`,r,s,o,8)})),o+=10,o=this.drawText(`Total: ${n}`,r,s,o,8)}this.resizeCanvas(e,r,e.width,o);let l=[e];return e.height>t&&(l=this.divideCanvas(e,t)),l},generateHtmlReport(){var t=this.$store.getters.getPaperSize,e=this.$store.getters.getFontSize,a=this.formatDate(this.date_search[0])==this.formatDate(this.date_search[1])?this.formatDate(this.date_search[0]):this.formatDate(this.date_search[0])+" à "+this.formatDate(this.date_search[1]);let r="print://escpos.org/escpos/bt/print?srcTp=uri&srcObj=html&src='data:text/html,";if(r+=`<div style="width: ${"58MM"==t?"219.21px":"302.36px"}; margin: 0; padding: 0; font-size: ${.7*e}">`,r+=`  \n            <div style="display: flex; flex-direction: column; align-items: center; padding-top: 5px; justify-content: center; border-bottom: solid black 1px; border-top: solid black 1px">\n                <span>GUIA DE PAGAMENTO</span>\n                <span>${a}</span>\n            </div>\n            `,r+=`\n            <div style="display: flex; flex-direction: column;">\n                <span>Período: ${a}</span>\n                <span>Ponto: ${this.loggedUser().point_name}</span>\n                <span>Anterior: ${this.formatCurrency(this.report.dev_anterior)}</span>\n                <span>Vendas: ${this.formatCurrency(this.report.vendas)}</span>\n                <span>Cancelamentos: ${this.formatCurrency(this.report.cancelamentos)}</span>\n                <span>Comissão: ${this.formatCurrency(this.report.comissao)}</span>\n                <span>Prêmios: ${this.formatCurrency(this.report.premios)}</span>\n                <span>Reclamação: ${this.formatCurrency(this.report.reclamacao)}</span>\n                <span>Despesa: ${this.formatCurrency(this.report.despesa)}</span>\n                <span>Recebido : ${this.formatCurrency(this.report.recebido)}</span>\n                <span>Enviado : ${this.formatCurrency(this.report.enviado)}</span>\n                <span>Cana : ${this.formatCurrency(this.report.cana)}</span>\n               \n            `,this.report.haver>0?r+=`\n                    <span>Dev: ${this.formatCurrency(this.report.haver)}</span>\n                </div>\n                `:r+=`\n                    <span>Haver: ${this.formatCurrency(this.report.haver)}</span>\n                </div>\n                `,this.report.expenseDetails.length>0){var s=this.formatCurrency(this.report.expenseDetails.reduce(((t,e)=>t+parseFloat(e.value)),0));r+='  \n                <div style="display: flex; padding-top: 5px; justify-content: center; border-bottom: solid black 1px; border-top: solid black 1px">\n                    <span>DESPESA DETALHADA</span>\n                </div>\n                ',r+='<div style="display: flex; flex-direction: column;">',this.report.expenseDetails.forEach((t=>{var e=t.description.charAt(0).toUpperCase()+t.description.toLowerCase().slice(1);r+=`<span>${e}: ${this.formatCurrency(parseFloat(t.value))}</span>`})),r+=`\n                    <span>TOTAL: ${s}</span>\n                </div>\n                `}return this.report.vendaPorExtracao.length>0&&(r+='  \n                <div style="display: flex; padding-top: 5px; justify-content: center; border-bottom: solid black 1px; border-top: solid black 1px">\n                    <span>RESUMO</span>\n                </div>\n                ',this.report.vendaPorExtracao.forEach((t=>{r+=`\n                    <div style="display: flex; padding-top: 5px; flex-direction: column; justify-content: center; border-bottom: solid black 1px; border-top: solid black 1px">\n                        <span>${t.name}</span>\n                        <span>Venda: ${this.formatCurrency(parseFloat(t.venda_total))}</span>\n                        <span>Comissão: ${this.formatCurrency(parseFloat(t.comissao_total))}</span>\n                        <span>Prêmio: ${this.formatCurrency(parseFloat(t.total_premio))}</span> \n                    <div>\n                    `}))),this.report.bilhetesSorteados.length>0&&(r+='  \n                <div style="display: flex; padding-top: 5px; justify-content: center; border-bottom: solid black 1px; border-top: solid black 1px">\n                    <span>PRÊMIOS</span>\n                </div>\n                ',this.report.bilhetesSorteados.forEach((t=>{r+=`\n                    <div style="display: flex; padding-top: 5px; flex-direction: column; justify-content: center; border-bottom: solid black 1px; border-top: solid black 1px">\n                        <span>${t.name}</span>\n                        <span>Ticket: ${t.id}</span>\n                        <span>Prêmio: ${this.formatCurrency(parseFloat(t.total_value))}</span> \n                    <div>\n                    `}))),r+="</div>",r+="</div>",r},toggleCalendar(){this.showCalendar=!this.showCalendar},toggleFilter(){this.showFilter=!this.showFilter},loadReport(){let t="Geral"==this.reportType?"reports/sellerPeriodReport":"reports/bolaoPeriodReport";this.$api.get(t,{headers:{Authorization:this.accessToken()},params:{from:at()(this.date_search[0]).format("YYYY-MM-DD"),to:at()(this.date_search[1]).format("YYYY-MM-DD")}}).then((t=>{this.report=t.data[0]})).catch((()=>{this.$toast.add({severity:"error",summary:"Erro",detail:"Erro ao carregar relatório",life:3e3})}))}}},st=a(40089);const ot=(0,st.Z)(rt,[["render",B],["__scopeId","data-v-6f9f629c"]]);var it=ot}}]);
//# sourceMappingURL=536.3956e3b9.js.map