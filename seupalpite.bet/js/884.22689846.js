"use strict";(self["webpackChunkjb_web_app"]=self["webpackChunkjb_web_app"]||[]).push([[884],{69884:function(t,e,i){i.r(e),i.d(e,{default:function(){return b}});var o=i(73396);const n=t=>((0,o.dD)("data-v-5d1bdec6"),t=t(),(0,o.Cn)(),t),a={class:"configPrinter"},s=n((()=>(0,o._)("h3",{style:{"margin-bottom":"10px"}},"Configurar impressora",-1))),r={class:"field"},d=n((()=>(0,o._)("span",null,"Tamanho do papel",-1))),h={class:"field"},p=n((()=>(0,o._)("span",null,"Método de impressão",-1))),l={class:"field"},c=n((()=>(0,o._)("span",null,"Tamanho da fonte",-1))),u=(0,o.Uk)("Imprimir teste");function m(t,e,i,n,m,g){const f=(0,o.up)("Dropdown"),T=(0,o.up)("Button");return(0,o.wg)(),(0,o.iD)("div",a,[s,(0,o._)("div",r,[d,(0,o.Wm)(f,{onChange:g.setPrintConfig,modelValue:m.paperSize,"onUpdate:modelValue":e[0]||(e[0]=t=>m.paperSize=t),options:["58MM","80MM"],placeholder:"Tamanho do papel"},null,8,["onChange","modelValue"])]),(0,o._)("div",h,[p,(0,o.Wm)(f,{onChange:g.setPrintMethod,modelValue:m.printMethod,"onUpdate:modelValue":e[1]||(e[1]=t=>m.printMethod=t),options:["Tipo 1","Tipo 2","Tipo 3","Tipo 4","Tipo 5"],placeholder:"Método de impressão"},null,8,["onChange","modelValue"])]),(0,o._)("div",l,[c,(0,o.Wm)(f,{onChange:g.setFontSize,modelValue:m.fontSize,"onUpdate:modelValue":e[2]||(e[2]=t=>m.fontSize=t),options:[24,26,28,30,32,34,36,38,40],placeholder:"Tamanho da fonte"},null,8,["onChange","modelValue"])]),(0,o.Wm)(T,{loading:m.loading,onClick:e[3]||(e[3]=t=>g.printTest())},{default:(0,o.w5)((()=>[u])),_:1},8,["loading"])])}i(82801);var g=i(31826),f=i(13789),T=i(15517),M=i(22419),S={components:{Button:g.Z,Password:f.Z,Dropdown:T.Z,Dialog:M.Z},data(){return{loading:!1,paperSize:null,printMethod:null,fontSize:null,showPrintConfig:!1,bluetoothAvailable:!1,bluetooth:{connected:!1,characteristics:null}}},created(){this.paperSize=this.$store.getters.getPaperSize,this.printMethod=this.$store.getters.getPrintMethod,this.fontSize=this.$store.getters.getFontSize},methods:{setPrintConfig(){this.$store.dispatch("setPaperSize",{paperSize:this.paperSize})},setPrintMethod(){this.$store.dispatch("setPrintMethod",{printMethod:this.printMethod})},setFontSize(){this.$store.dispatch("setFontSize",{fontSize:this.fontSize})},printTest(){if("Tipo 1"==this.printMethod){var t=this.drawPrintTest();document.location="rawbt:"+t.toDataURL()}if("Tipo 2"==this.printMethod){this.loading=!0;let t=this.drawPrintTest();t.toBlob((t=>{this.$api.post("/images/stores3",{attachment:t},{headers:{"Content-Type":"multipart/form-data",Authorization:this.accessToken()}}).then((t=>{const e=btoa(t.data.url+"&width="+("80MM"==this.paperSize?576:376));document.location=`buprinter://print/${e}`,this.loading=!1})).catch((t=>{console.log(t),this.loading=!1}))}))}if("Tipo 3"==this.printMethod){var e=this.generateHtmlTest();document.location.href=e,this.$router.push({path:this.path})}if("Tipo 4"==this.printMethod){this.loading=!0;let t=this.drawPrintTest();this.$api.post("/images",{base64:t.toDataURL(),height:t.height,width:t.width},{headers:{Authorization:this.accessToken()}}).then((t=>{document.location=`buprinter://print/${t.data.image.id}`,this.loading=!1})).catch((t=>{this.loading=!1,console.log(t)}))}if("Tipo 5"==this.printMethod){this.loading=!0;let t=this.drawPrintTest();t.toBlob((t=>{this.$api.post("/images/stores3",{attachment:t},{headers:{"Content-Type":"multipart/form-data",Authorization:this.accessToken()}}).then((t=>{document.location=`imageprinterapp://${t.data.url}&width=${this.paperSize}`,this.loading=!1})).catch((()=>{this.loading=!1}))}))}},drawPrintTest(){var t=document.createElement("canvas");t.width="80MM"==this.paperSize?576:376,t.height=3e4;var e=t.getContext("2d");let i=0,o=10;return o=this.drawLine(e,i,o),o=this.drawTitle("IMPRESSÃO TESTE",e,t.width/2,o),o=this.drawLine(e,i,o),o=this.drawText("Funcionando!",e,i,o),this.resizeCanvas(t,e,t.width,o),t},generateHtmlTest(){let t="print://escpos.org/escpos/bt/print?srcTp=uri&srcObj=html&src='data:text/html,";return t+=`<div style="width: ${"58MM"==this.paperSize?"219.21px":"302.36px"}; margin: 0; padding: 0">`,t+=`  \n            <div style="display: flex; justify-content: center; font-size: ${this.fontSize}; border-bottom: solid black 1px; border-top: solid black 1px">\n                <span>IMPRESSÃO TESTE</span>\n            </div>\n            `,t+="<span>Funcionando!</span>",t+="</div>",t}}},w=i(40089);const z=(0,w.Z)(S,[["render",m],["__scopeId","data-v-5d1bdec6"]]);var b=z}}]);
//# sourceMappingURL=884.22689846.js.map