"use strict";(self["webpackChunkjb_web_app"]=self["webpackChunkjb_web_app"]||[]).push([[948],{9948:function(e,s,a){a.r(s),a.d(s,{default:function(){return v}});var o=a(73396),t=a(87139);const i=e=>((0,o.dD)("data-v-0ee10561"),e=e(),(0,o.Cn)(),e),r={class:"comissions"},n={class:"title-section"},l=i((()=>(0,o._)("h3",null,"Comissões",-1))),d={class:"datatable-container"};function c(e,s,a,i,c,u){const h=(0,o.up)("Button"),m=(0,o.up)("Calendar"),p=(0,o.up)("Dropdown"),g=(0,o.up)("Column"),_=(0,o.up)("DataTable");return(0,o.wg)(),(0,o.iD)("div",r,[(0,o._)("div",n,[l,(0,o.Wm)(h,{icon:"fa-solid fa-sliders",onClick:u.toggleFilter},null,8,["onClick"])]),(0,o._)("div",{class:"filter-container",style:(0,t.j5)(c.showFilter?"display: grid":"display: none")},[(0,o.Wm)(m,{ref:"calendarRef",showClear:"",maxDate:new Date,modelValue:c.date_search,"onUpdate:modelValue":s[0]||(s[0]=e=>c.date_search=e),dateFormat:"dd/mm/yy",selectionMode:"range",showIcon:!0},null,8,["maxDate","modelValue"]),(0,o.Wm)(p,{placeholder:"Usuário recomendado",onChange:s[1]||(s[1]=e=>u.loadComissions()),modelValue:c.user_search,"onUpdate:modelValue":s[2]||(s[2]=e=>c.user_search=e),optionLabel:"email",optionValue:"id",options:c.users,showClear:""},null,8,["modelValue","options"])],4),(0,o._)("div",d,[(0,o.Wm)(_,{value:c.comissions,rows:c.perpage,dataKey:"id",paginator:!0,class:"p-datatable-sm",loading:c.loading.comissions,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[10,25,50],currentPageReportTemplate:"Exibindo {first} à {last} de {totalRecords} registros",responsiveLayout:"scroll"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{field:"created_at",header:"Data",sortable:"",footer:"TOTAL"},{body:(0,o.w5)((e=>[(0,o.Uk)((0,t.zw)(this.formatDateFull(e.data.created_at)),1)])),_:1}),(0,o.Wm)(g,{field:"online_user",header:"Usuário",sortable:""},{body:(0,o.w5)((e=>[(0,o.Uk)((0,t.zw)(e.data.online_user.length>18?e.data.online_user.substr(0,18)+"...":e.data.online_user),1)])),_:1}),(0,o.Wm)(g,{field:"comission_value",header:"Valor",sortable:"",footer:u.sumField("comission_value")},{body:(0,o.w5)((e=>[(0,o.Uk)((0,t.zw)(this.formatCurrency(parseFloat(e.data.comission_value))),1)])),_:1},8,["footer"])])),_:1},8,["value","rows","loading"])])])}var u=a(31826),h=a(62711),m=a(79692),p=a(15517),g=a(47469),_=a(23717),w={components:{Button:u.Z,Calendar:h.Z,Spinner:m.Z,Dropdown:p.Z,DataTable:g.Z,Column:_.Z},data(){return{loading:{comissions:!1,users:!1},user_search:null,date_search:[new Date((new Date).setDate((new Date).getDate()-30)),new Date],showFilter:!1,comissions:[],users:[],perpage:10}},created(){this.loadComissions(),this.loadUsers()},watch:{date_search:function(e){e[0]&&e[1]&&(this.loadComissions(),this.$refs.calendarRef.overlayVisible=!1)}},methods:{sumField(e){return this.comissions.reduce(((s,a)=>s+(parseFloat(a[e])||0)),0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}).replace("R$","")},toggleFilter(){this.showFilter=!this.showFilter},loadUsers(){this.loading.users=!0,this.users=[],this.$api.get("comissions/users",{headers:{Authorization:this.accessToken()}}).then((e=>{this.users=e.data,this.loading.users=!1})).catch((e=>{this.$toast.add({severity:"error",summary:"Erro",detail:e.response.data.error,life:3e3}),this.loading.users=!1}))},loadComissions(){this.loading.comissions=!0,this.comissions=[],this.$api.get("comissions/online_comissions",{headers:{Authorization:this.accessToken()},params:{from:this.date_search[0],to:this.date_search[1],user_search:this.user_search}}).then((e=>{this.comissions=e.data,this.loading.comissions=!1})).catch((e=>{this.$toast.add({severity:"error",summary:"Erro",detail:e.response.data.message,life:3e3}),this.loading.comissions=!1}))}}},f=a(40089);const b=(0,f.Z)(w,[["render",c],["__scopeId","data-v-0ee10561"]]);var v=b}}]);
//# sourceMappingURL=948.7d0b0b71.js.map