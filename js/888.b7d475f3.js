"use strict";(self["webpackChunkjb_web_app"]=self["webpackChunkjb_web_app"]||[]).push([[888],{8888:function(t,e,i){i.r(e),i.d(e,{default:function(){return f}});i(26699);var a=i(73396),o=i(87139);const s=t=>((0,a.dD)("data-v-2761c9f5"),t=t(),(0,a.Cn)(),t),d={class:"repeat-ticket"},r=s((()=>(0,a._)("h3",null,"Repetir bilhete",-1))),c={class:"search"},n=s((()=>(0,a._)("div",{style:{position:"absolute",top:"19px",left:"50px"}}," Todos ",-1))),l={key:0};function h(t,e,i,s,h,u){const p=(0,a.up)("Dropdown"),g=(0,a.up)("MultiSelect"),m=(0,a.up)("InputText"),k=(0,a.up)("Button"),_=(0,a.up)("qrcode-stream");return(0,a.wg)(),(0,a.iD)("div",d,[r,(0,a._)("div",c,[(0,a.Wm)(p,{optionLabel:"name",optionValue:"name",modelValue:h.selectedProduct,"onUpdate:modelValue":e[0]||(e[0]=t=>h.selectedProduct=t),options:h.products,placeholder:"Produto"},null,8,["modelValue","options"]),["bauzinho","tradicional","ligeirinha"].includes(h.selectedProduct)?((0,a.wg)(),(0,a.j4)(g,{key:0,modelValue:h.selectedExtractions,"onUpdate:modelValue":e[1]||(e[1]=t=>h.selectedExtractions=t),options:h.extractions,optionLabel:"name",placeholder:"Horário"},{header:(0,a.w5)((()=>[n])),_:1},8,["modelValue","options"])):(0,a.kq)("",!0),(0,a.Wm)(m,{label:"Código do bilhete",modelValue:h.ticket_id,"onUpdate:modelValue":e[2]||(e[2]=t=>h.ticket_id=t)},null,8,["modelValue"]),(0,a.Wm)(k,{onClick:u.handleFindTicket,class:"btn-submit",label:"Repetir bilhete",loading:h.loading},null,8,["onClick","loading"]),(0,a.Wm)(k,{onClick:u.toggleshowQrcodeReader,class:"btn-submit",label:"Ler QRCODE"},null,8,["onClick"])]),h.showQrcodeReader?((0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("p",null,[(0,a._)("b",null,(0,o.zw)(h.error),1)]),(0,a.Wm)(_,{camera:h.camera,onDecode:u.onDecode,onInit:u.onInit},null,8,["camera","onDecode","onInit"])])):(0,a.kq)("",!0)])}var u=i(31826),p=i(76709),g=i(81937),m=i(15517),k=i(64376),_={components:{Button:u.Z,Divider:g.Z,InputText:p.Z,Dropdown:m.Z,MultiSelect:k.Z},data(){return{extractions:[],products:[],selectedProduct:null,selectedExtractions:[],ticket_id:null,loading:!1,camera:"auto",error:null,showQrcodeReader:!1,productMap:{tradicional:{product_id:1,getTicket:"tickets/getTicketById",getExtractions:"extraction",betPath:"bet/tradicional",id:2},ligeirinha:{product_id:2,getTicket:"tickets/getTicketById",getExtractions:"extraction",betPath:"bet/ligeirinha",id:3},bauzinho:{product_id:4,getTicket:"tickets/getTicketById",getExtractions:"extraction",betPath:"bet/bau",id:2},instantaneo:{product_id:3,getTicket:"tickets/getTicketById",getExtractions:"extraction",betPath:"bet/instantaneo",id:2},quininha:{product_id:6,getTicket:"caixa_tickets/getTicketById",getExtractions:"contests",betPath:"bet/quininha",id:1},seninha:{product_id:8,getTicket:"caixa_tickets/getTicketById",getExtractions:"contests",betPath:"bet/seninha",id:2},"quina brasil":{product_id:7,getTicket:"caixa_tickets/getTicketById",getExtractions:"contests",betPath:"bet/quinabrasil",id:4},lt:{product_id:9,getTicket:"caixa_tickets/getTicketById",getExtractions:"contests",betPath:"bet/lt",id:5},"bolao de dezenas":{product_id:5,getTicket:"round_tickets/getTicketById",getExtractions:"rounds/currentRound",betPath:"bet/bolaoDezenas",id:0}}}},created(){this.products=Object.values(this.$store.getters.getProducts).filter((t=>t.habilitado))},watch:{selectedProduct:function(){this.selectedProduct&&this.loadExtractions()}},methods:{toggleshowQrcodeReader(){this.showQrcodeReader?this.turnCameraOff():this.turnCameraOn()},turnCameraOn(){this.camera="auto",this.showQrcodeReader=!0},turnCameraOff(){this.camera="off",this.showQrcodeReader=!1},async onDecode(t){var e=JSON.parse(t);this.ticket_id=e[0].id,this.selectedExtractions.length<1||null==this.ticket_id?this.$toast.add({severity:"error",summary:"Erro",detail:"Um ou mais campos não foram preenchidos.",life:3e3}):(this.handleFindTicket(),this.turnCameraOff())},onInit(t){t.catch(console.error).then(this.resetValidationState)},loadExtractions(){this.selectedExtractions=[],this.$api.get(this.productMap[this.selectedProduct].getExtractions,{headers:{Authorization:this.accessToken()},params:{lottery_search:this.productMap[this.selectedProduct].id,caixa_lottery_search:this.productMap[this.selectedProduct].id,limit:this.$store.getters.getRegionConfig.max_contests}}).then((t=>{"Bolao de dezenas"==this.selectedProduct?this.extractions=[t.data]:this.extractions=t.data})).catch((t=>{console.log(t)}))},handleFindTicket(){null!=this.ticket_id?["Bauzinho","Tradicional","Ligeirinha"].includes(this.selectedProduct)&&this.selectedExtractions.length<1?this.$toast.add({severity:"error",summary:"Erro",detail:"Você deve selecionar um horário.",life:3e3}):(this.loading=!0,this.$api.get(`${this.productMap[this.selectedProduct].getTicket}/${this.ticket_id}`,{headers:{Authorization:this.accessToken()}}).then((t=>{if(t.data.product_id&&t.data.product_id!=this.productMap[this.selectedProduct].product_id)return this.$toast.add({severity:"error",summary:"Erro",detail:"Esse bilhete não faz parte do produto selecionado.",life:5e3}),void(this.loading=!1);this.$store.dispatch("setRepeatTicket",{repeat_ticket:{extractions:this.selectedExtractions,ticket:t.data}}),this.$router.push({path:this.productMap[this.selectedProduct].betPath}),this.loading=!1,this.ticket=t.data,this.$toast.add({severity:"success",summary:"Sucesso",detail:"Palpite adicionado ao bilhete!",life:3e3})})).catch((()=>{this.loading=!1,this.$toast.add({severity:"error",summary:"Erro",detail:"Não foi possível encontrar o bilhete",life:3e3})}))):this.$toast.add({severity:"error",summary:"Erro",detail:"Número do bilhete inválido.",life:3e3})},repeatJbTicket(t){var e=[];for(let a=0;a<this.selectedExtractions.length;a++)for(let o=0;o<t.games.length;o++){var i={ref:Math.floor(Date.now()*Math.random()),loteria:this.selectedExtractions[a].name,extraction:this.selectedExtractions[a].id,region_id:this.loggedUser().region_id,point_id:this.loggedUser().point_id,point_name:this.loggedUser().point_name,lottery_id:this.productMap[this.selectedProduct].id,modalidade:t.games[o].modality_name,modality_id:t.games[o].modality_id,award_name:t.games[o].award.name,award_internal:t.games[o].award.internal_name,valor:t.games[o].value,palpites:JSON.parse(t.games[o].selected_numbers),positions:JSON.parse(t.games[o].selected_positions)};e.push(i)}this.$store.dispatch("addGame",{newGames:e})}}},b=i(40089);const x=(0,b.Z)(_,[["render",h],["__scopeId","data-v-2761c9f5"]]);var f=x}}]);
//# sourceMappingURL=888.b7d475f3.js.map